# 病毒序列遗传进化分析
---

# 目录
~~插入目录~~

## 序列拼接文件准备
![](./picture/学习笔记-病毒序列遗传进化分析-文件准备.png)

## 全基因序列sanger测序结果拼接
1. 在snapgene的理论序列中导入所有**上下游引物和蛋白质features**，将每次测序回来的正反向结果在snapegne中与理论序列文件进行比对，比对成功的序列放在`"测序结果可用序列" `文件夹中
2. 测齐所有片段后，拼接时注意：
   1. snapgene中会显示每段序列比对上理论序列的位置和每个测序碱基的质量，可用来后面在seqman中截去质量不好的序列<https://www.bilibili.com/video/BV1pQ4y1d7Ac?spm_id_from=333.337.search-card.all.click>  
   2. sanger测序结果初步分析<https://www.jianshu.com/p/12fe560c3eaf>
   3. 在seqman中导入可用正反向序列测序结果，结合`步骤1`snapgene比对结果进行截取每一段测序结果前后质量不好的碱基<https://www.bilibili.com/video/BV1pr4y1w7aE/?spm_id_from=333.788.recommend_more_video.0>    
   4. 去除载体序列，进行拼接；注意有冲突时，5'端结果可信度大于3'端的结果可信度<https://wenku.baidu.com/view/2510ca7965ce05087732133d.html>  
   5.  当pcr片段之间重叠区域太少时，用seqman拼接时会断开，可以手动把断开的序列拼接起来<https://www.bilibili.com/video/BV1D44y1B7r8?spm_id_from=333.337.search-card.all.click>
3. 将测序结果的可用正反向序列同时用snapgene和理论序列进行比对用来先**依次拼好**每一段蛋白质features  
注意要**根据文献查询到的全基因蛋白结构**，将全序列的蛋白质features依次拼好，每完成一个包括目标蛋白质feature就要去ncbi进行ORF Finder，最后再来合并成一条完整的全序列<https://mp.weixin.qq.com/s/mI5VBiDrTYhsOSoDwi_hTQ>    
4. 导出拼接好的全基因序列文件  `"Contig"→"Save Consensus"→选择需要的格式保存 `  
5. 导出的fasta文件要在blast中比对<https://www.bilibili.com/video/BV1ZB4y1c7jS?spm_id_from=333.999.0.0>  
   
6.  最后将完整序列去ncbi进行ORF Finder，看ORF区域是否符合蛋白质features预期，不符合预期回到`步骤3 `，再依次重新往下进行   
 
## 确定参考序列
1. 将拼接好的序列去blastn，确定与哪些病毒毒株的序列比对上，用来初步确定要下载哪些参考序列     
2. 下载最新的有价值的文献的参考序列表格（运用好excel文本拆分和转置），然后包括这些文献所研究出来的最新病毒序列也要下载，后续可以根据`步骤1 `的blast结果和初步构建简单的进化树，来确定删除和增加参考序列    
  
## 下载参考序列和序列id修改
1. 下载参考序列<https://www.bilibili.com/medialist/play/watchlater/BV1c3411C72T>    
2. 序列id修改<https://www.bilibili.com/medialist/play/watchlater/BV1e64y1a7M2>  
3. 在mega中打开修改好后的序列id进行检查，在mega打开序列时，id中空格会自动改成`_`，最终版本的序列id应全部用`_`替代掉空格。

## mafft进行多重序列比对
1. [mafft与其他比对方法的比较](https://www.yuque.com/wusheng/gw7a9p/ibylou)    
2. [mafft各个算法详解](https://www.yuque.com/wusheng/gw7a9p/dslc0k)    
3. mafft多重序列比对和方法选择实操<https://www.bilibili.com/medialist/play/watchlater/BV1Mf4y11756>   